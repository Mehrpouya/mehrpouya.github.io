  <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Hadi Mehrpouya</title>

    <!-- Bootstrap core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">

    <!-- Custom styles for this template -->

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-43516761-4', 'auto');
    ga('send', 'pageview');

    </script>
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Hadi Mehrpouya</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="/PhD" target="_blank">PhD</a></li>
	    <li><a href="/projects">Projects</a></li>
	    <li><a href="http://hadimeh.tumblr.com/">Photography(Tumblr)</a></li>
	    <li><a href="/blog">blog</a></li>
            <li><a href="/publications">Publications</a></li>
            <li><a href="/about">About</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container postsContainer leftAlign">

  <h1>Phillips Light Bulb Diary:</h1>

<p>The Phillips Light Bulb project was recently featured in the <a href="http://www.heraldscotland.com/news/home-news/the-power-of-knoydart-lights-up-community.127060619">Herald Scotland</a> and <a href="http://www.deadlinenews.co.uk/2015/05/26/lightbulb-warns-remote-community-of-power-blackout/">Deadline News</a>, and as part of the development team behind the work, thought it would be helpful to document how the project was developed and the code behind the project.</p>

<h2>How it all came together:</h2>

<p>In August 2014 <a href="http://www.sps.ed.ac.uk/staff/social_anthropology/cross_jamie">Jamie Cross</a> Co-investigator of <a href="http://lifeoffthegrid.net">Off the Grid</a> asked <a href="http://hadi.link">myself</a> and <a href="https://github.com/modulo-">Margus Lind</a> to join another project that he was leading in collaboration with <a href="http://www.knoydart-foundation.com">Knoydart Foundation</a>, <a href="http://www.localenergyscotland.org">Local Energy Scotland</a> and <a href="http://www.communityenergyscotland.org.uk">Community Energy Scotland</a>.</p>

<p>After developing a few data visualisations to try and find a way to translate the data from this tracker, and fragility of this micro-hydro into something more meanngful for the community without creating panic.</p>

<p><img src="/assets/Knoydart/tracker.jpg" alt="Tracker"> <img src="/assets/Knoydart/hydro.jpg" alt="Hydro"></p>

<p>Sitting in the <a href="http://www.knoydart-foundation.com/bunkhouse/about-the-bunkhouse/">Knoydart bunkhouse</a> the three of us joined by <a href="http://www.knoydart-foundation.com/about/about-the-foundation/knoydart-renewables/">Kyle Smith</a> operations manager of <a href="http://www.knoydart-foundation.com">Knoydart Foundation</a> and <a href="http://www.communityenergyscotland.org.uk/our-team.asp?id=29">Benny Talbot</a> from Community Energy Scotland.
We were trying to find a way to engage with the community and tourists about how to have better awareness of energy consumption to avoid power cuts and develop ways to use the surplass energy.</p>

<p>After a couple of hours of writing down ideas and sketches, <a href="http://www.knoydart-foundation.com/about/about-the-foundation/knoydart-renewables/">Kyle</a> mentioned if we have seen the new <a href="http://www2.meethue.com/en-gb/">Phillips smart light bulbs</a>. None of us have heard about them before, however after a few more hours of research, the next day <a href="https://github.com/modulo-">Margus</a> developed the first hack of the light bulb. We managed on our last night in Knoydart to install it on one of the computers in the community library. The purpose was to change the color of the light bulb according to the community energy consumption.</p>

<p>And this is what we left there for the following 3 months.</p>

<p><img src="/assets/Knoydart/philips-library.jpg" alt="Phillips Hue in the library"></p>

<h2>First evaluation:</h2>

<p>We ran focus groups, interviewed people and made various versions of our visualisations. Finally the community were happy with three final designs.</p>

<p><img src="/assets/Knoydart/first-focusgroup.jpg" alt="focus group"></p>

<p>1:Smart light bulb</p>

<p>2:The new <a href="http://powerofknoydart.org/">Power of knoydart website</a></p>

<p>3:Data kettle (a widget for windows computers that shows the amount of energy consumption as a water level in a kettle).</p>

<p>When we went back to Knoydart at the end of same year, we found out that not many people knew about our <a href="http://powerofknoydart.org/">Power of knoydart website</a>. Furthermore all of the lights in the library have been removed, and sadly not many people installed our kettle on their computers.</p>

<p>Not knowing about our website or the kettle widget was because of reasons as simple as: some lost the link to the page, some didn&#39;t know about it, and some found it unreliable that the page was often down.</p>

<p>The lights being moved from the library was again because our script lost communication with data server and the light bulb.</p>

<h2>Iterations:</h2>

<p>To solve the advertising problem <a href="http://www.sps.ed.ac.uk/staff/social_anthropology/cross_jamie">Jamie</a> printed out 300 water proof stickers that could be put in different locations as a point of reference. We&#39;ve got one on our meeting room at Design informatics, here at University of Edinburgh!</p>

<p>To solve the reliability problem, we asked <a href="https://github.com/TerribleBugger">Chris Barker</a> to join our team. The two of us developed a new and clean page for <a href="http://powerofknoydart.org/">Power of Knoydart</a>, made it more resilient and made an easy installation for the <a href="http://www.powerofknoydart.org/downloads.html">data kettle</a> and we all advertised it on any medium that we could like twitter, facebook and so on.</p>

<p>The last problem was to light the light bulb. We needed to bring it to somewhere more public and in the view of both tourists and the community.
We made a new version of the code which is documented and accessible on here: <a href="https://github.com/Mehrpouya/PowerOfKnoydart">Power of Knoydart</a></p>

<h2>Open source code and documentation:</h2>

<p>I will publish the Phillips python code on the <a href="https://github.com/Mehrpouya/PowerOfKnoydart">Power of Knoydart website</a> in the next couple of days.
Here&#39;s how to do it yourself:</p>

<h2>Here&#39;s how we hacked the Phillips light:</h2>

<p>Get yourself a:</p>

<p><strong>Raspberry pie</strong> (Instead of using a big computer, use one of these to save power and easy installation)</p>

<p><strong>Phillips Hue</strong></p>

<p><strong>Miniature wifi</strong> (You need this to connect to the internet)</p>

<p>First You need to install a couple of libraries on the Raspberry pie in order to talk to the Phillips Hue light bulb.</p>

<p>Here&#39;s the list of libraries:</p>

<p><strong>interp</strong> (You need this to convert numerical ranges, for example in our case if we&#39;re using 10kwh of electricity convert it to a range of green and if it&#39;s more that 140 - 180 convert it to a range of red)</p>

<p><strong>phue</strong> (This is the imporatant library that let&#39;s you speak with the smart bulb)</p>

<p>That&#39;s it. Install these by <a href="http://google.com">googling</a> or <a href="http://duckduckgo.com">ducking</a> their name and python together.</p>

<p>And here&#39;s the simple code:</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="sd">&#39;&#39;&#39;IP address of the Phillips Hue&#39;&#39;&#39;</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">phue</span><span class="o">.</span><span class="n">Bridge</span><span class="p">(</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">)</span>
<span class="sd">&#39;&#39;&#39;You can get it from their online console.&#39;&#39;&#39;</span>
<span class="n">b</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">get_api</span><span class="p">()</span>
<span class="n">r</span><span class="o">=</span><span class="mi">0</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div>
<p>And then, changing light bulbs color according to your data, in my case it was a number between 0-180</p>
<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">if</span> <span class="n">num</span><span class="o">&gt;</span><span class="mi">150</span> <span class="ow">and</span> <span class="n">num</span><span class="o">&lt;=</span><span class="mi">180</span><span class="p">:</span> <span class="c">#num has the number I mentioned, the data you want to visualise into light colors.</span>
    <span class="n">hue</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">interp</span><span class="p">(</span><span class="n">r</span><span class="p">,[</span><span class="mi">150</span><span class="p">,</span><span class="mi">180</span><span class="p">],[</span><span class="mi">5000</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span> <span class="c">#interp will interpolate the values to the range I want here is red</span>
<span class="k">elif</span> <span class="n">num</span><span class="o">&gt;</span><span class="mi">100</span> <span class="ow">and</span> <span class="n">num</span><span class="o">&lt;=</span><span class="mi">150</span><span class="p">:</span>
    <span class="n">hue</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">interp</span><span class="p">(</span><span class="n">r</span><span class="p">,[</span><span class="mi">100</span><span class="p">,</span><span class="mi">150</span><span class="p">],[</span><span class="mi">15000</span><span class="p">,</span><span class="mi">10000</span><span class="p">]))</span><span class="c">#here is yellow</span>
<span class="k">elif</span> <span class="n">num</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">num</span><span class="o">&lt;=</span><span class="mi">100</span><span class="p">:</span>
    <span class="n">hue</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">interp</span><span class="p">(</span><span class="n">r</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],[</span><span class="mi">30000</span><span class="p">,</span><span class="mi">25000</span><span class="p">]))</span><span class="c">#green</span>
<span class="n">bri</span><span class="o">=</span><span class="mi">255</span> <span class="c">#brightness of the light</span>
<span class="n">sat</span><span class="o">=</span><span class="mi">254</span> <span class="c">#saturation of the light</span>
<span class="n">lights</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">lights</span> <span class="c">#this will give me the list of light bulbs to iterate through</span>
<span class="n">command</span> <span class="o">=</span> <span class="p">{</span><span class="c">#preparing a command to send to the Phillips Hue controller</span>
        <span class="s">&#39;transitiontime&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span><span class="c">#how long to take to change to a new color.</span>
        <span class="s">&#39;on&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s">&#39;bri&#39;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
        <span class="s">&#39;hue&#39;</span><span class="p">:</span> <span class="n">hue</span><span class="p">,</span>
        <span class="s">&#39;sat&#39;</span><span class="p">:</span> <span class="mi">255</span>
    <span class="p">}</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lights</span><span class="p">:</span><span class="c">#iterate through and change colors.</span>
    <span class="k">print</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">set_light</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
    </div><!-- /.container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
  </body>
</html>

<link href="/css/bootstrap.css" rel="stylesheet">
<style>
  body {
    padding-top: 60px;
  }
</style>


